% Draft of paper for Zone based traffic-sensitive routing
% The aim here is to show an increase in scalibility with a preservation of traffic reduction (show that the zone system will work with any model)

\documentclass[conference]{IEEEtran}
\usepackage{mathtools}

\usepackage{algorithm}% http://ctan.org/pkg/algorithms
\usepackage{algpseudocode}% http://ctan.org/pkg/algorithmicx
\usepackage{algpseudocode}

\usepackage{graphicx}
\graphicspath{ {images/} }

\hyphenation{op-tical net-works semi-conduc-tor}

\begin{document}
\raggedbottom

\title{Working Title: Z-BAR: A Zone-Based traffic Assignment Algorithm for scalable congestion Reduction}
% A novel algorithm for scalable traffic congestion reduction
% An adaptible model for scalability in traffic assignment algorithms

\author{\IEEEauthorblockN{Taylor Cox}
\IEEEauthorblockA{Department of Computer Science\\
University of Manitoba\\
Winnipeg, Manitoba\\
Email: coxt3@myumanitoba.ca}}

\maketitle

\begin{abstract}


\end{abstract}

\begin{IEEEkeywords}
Zones, Traffic Assignment, Congestion Reduction, Scalibility
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

% outline from meeting has section breakdown:
\section{Introduction}

Intelligent Transportation Systems (ITS) aim to improve urban transit and travel experiences using modern technology, particularly through the development of smart cities. One criterion for the success of a smart city is the optimization of traffic flow. Traffic assignment optimization is an emerging subarea of ITS. Recent work in the traffic assignment optimization literature aims to influence driver behavior without requiring individual drivers to embark on suboptimal routes. A balance must be struck between driver selfishness and system optimum.

Traffic assignment optimization is a research area of high social and ecological impact. Urban traffic optimization is crucial to addressing grand-scale socioecological issues such as climate change. In a natural system, drivers tend to exhibit selfish behavior. This creates significant congestion in key areas, such as a city's downtown core. Such congestion leads to runaway emissions of carbon-based pollutants, and causes strain on day-to-day productivity.

The goal of this paper is to investigate a novel strategy for scaling existing traffic assignment systems to very large networks. This includes both artificial and real-world traffic scenarios. This paper aims to apply existing congestion reduction strategies against large, realistic inputs. In this work, cities are treated as discrete-time, multi-agent systems with no central control. This paper examines a specific strategy for the scalability of traffic assignment optimization. This strategy is one based on partial centralization. We propose that traffic networks be partitioned into zones, where the path between all vertex pairs within one zone is stored in advance and evaluated at the zone-level. This reduces the time taken for individual vehicles to evaluate an optimal path. This zone-based approach is implemented in an algorithm dubbed Z-BAR, examined in detail later in this work.

An Ant Colony Optimization (ACO) traffic assignment algorithm inspired by \cite{iaco} is implemented in this work as a template for illustrating the scalability Z-BAR provides. Since Z-BAR's purpose is scalability as opposed to traffic assignment itself, any decentralized traffic assignment model will be compatible with Z-BAR. With scaling provided by Z-BAR, the traffic assignment algorithm is executed against mutliple artificial and real-world scenarios of increasing network and population size. To the knowledge of the authors, this is the first work which specifically addresses the scalability of traffic assignment optimization algorithms, and does so using the concept of zones.

The remainder of the paper is organized as follows: Section 2 covers an overview of relevant work; Section 3 describes the algorithm Z-BAR; Section 4 describes the simulation environment; Section 5 describes select experiments and their results. Finally, Section 6 presents the conclusions of this paper, accompanied by a discussion of future work.

% objective: traffic reduction scaled %

\section{Related Work} % existing lit and particularly IACO - and its issues. Also need HOPNET for foundation
% related work really splits into two parts.

% go through the relevant papers. IACO DTPOS in particular
The traffic assignment problem has been studied thoroughly in the literature, with foundations dating as far back as [*] and [*]. In recent works, Ant Colony Optimization (ACO) has proved to be successful in discovering new techniques for traffic assignment optimization. Originally proposed in [*], ACO is implemented by a set of ants acting upon a graph G = (V, E). Ants deposit pheromone on the routes they traverse, signalling the strength of their path to future ants. The ACO technique has been used in the traffic assignment problem by representing vehicles as ants. Vehicles leave a pheromone signal on the roads they traverse, permitting a characterization of vehicle density on an edge E. This vehicle-as-ant approach has been explored in [*] and [*]. The results in both works show that an ACO system reduces overall travel and wait times, but does not require any vehicles to embark on a suboptimal path in order to achieve a global optimum. Some vehicles may take physically longer routes to their destination, but none will will increase their travel time. Despite their success, these works were not applied to datasets of realistic scale. Both [*] and [*] were tested on relatively small artificial and real-world traffic networks, with up to 10,000 vehicles in a single simulation. Addtional work must be done to ensure the scalability of existing traffic assignment techniques.

Outside of traffic optimization, there is work done in the literature which covers the problem of scalability in graphs. Much of this work is focused on optimizing routing algorithms in large networks. In the study of networking, routing algorithms are divided into proactive, reactive and hybrid algorithms. In a proactive routing environment, nodes continuously broadcast their routing tables to their neighbours. This guarantees consistency of optimal routes but comes with a high cost of continued route maintenance. Alternatively, reactive routing involves nodes evaluating optimal paths on demand. While routes do not need to be maintained in a reactive protocol, the cost of evaluating new routes can be high in sufficiently large networks. Hybrid routing protocols are those which combine aspects from both proactive and reactive protocols. Some hybrid routing protocols are able to use the advantages of both proactive and reactive protocols without introducing any new disadvantages. One such hybrid protocol is the Zone Routing Protocol (ZRP). The ZRP has was first introduced in [*] and has since been used in a variety of applications. In a zone routing environment, the network is divided into zones, where nodes may belong to one or more overlapping zones. Within each zone, the path between each pair of vertices v1 and v2 is always known in advance. Intrazone paths are updated frequently, creating a proactive routing environment within each zone. When a multi-zone route is required, the local routes stored within each zone is joined together to form a path which traverses multiple zones. This reduces the total amount of message delivery by resorting to reactive routing only when necessary. Applications of the zone routing protocol has been studied in works including [*] and [*], showing the usefulness of zones in mobile and vehicular ad-hoc networks (MANET/VANET). 

\begin{figure}[h]
\caption{Example of multi-zone routing}
\centering
\includegraphics[scale=0.5]{zones_example}
\end{figure}

In the literature, zone-based routing has been successful in a wide array of applications. It is anticipated that a zone-routing strategy will be successful in improving the scalibility of existing traffic assignment algorithms. Storing optimal (least congested) intrazone paths and evaluated interzone paths on demand is a more scalable alternative to evalauting whole-network paths on every vehicle traversal. To the knowledge of the authors, the zone routing protocol has not been applied to the traffic assignment optimization problem.

\section{Z-BAR Algorithm} % how we will tackle the issues, give the algorithm

The Z-BAR algorithm involves the partioning of a traffic network into multiple zones. Local routes within each zone are proactively maintained by routing tables, while vehicles individually evaluate their routes reactively when traversing across multiple zones. The network is divided into a number of zones proportional to the total number of roads in the network. A zone consists of all nodes within a radius \textit{r} of some center node. This includes the edges between all member nodes. The radius of a node is determined by the number of hops required to reach the node from the center. The previous figure shows a zone system with a radius of 2. If a node is exactly \textit{r} hops away from its center, it is designated a border node. Border nodes are responsible for maintaining the paths between all of the zones in which they belong. The Z-BAR algorithm is divided into three components: zone formation, route maintenance and route discovery.

\subsection{Zone Formation}

The first step of Z-BAR is the division of the road network into multiple zones. Each zone consists of all nodes and edges up to \textit{r} hops from the center. Zones are responsible for their own routing tables, a data structure which stores the optimal path between each pair of vertices within a zone. Routing tables are initialized on zone creation, and populated during route maintenance. The zone formation step of Z-BAR proceeds until each node belongs to at least one zone.

% zone setup pseudocode 
\begin{algorithm}[H]
  \caption{Zone Formation}
  \label{zone_formation}
  \begin{algorithmic}[1] % The number tells where the line numbering should start
  \Procedure{Formation}{$G$}
  \State{$Zones \gets [\ ]$}
  \For{$v \in G$}
    \If{$v\ unassigned$}
      \State{$center \gets v$}
      \State{$Z \gets newZone(radius, center, G)$}
      \State{$Zones.append(Z)$}
    \EndIf
  \EndFor
  \State{$return\ Zones$}
  \EndProcedure
  \end{algorithmic}
\end{algorithm}

% complexity analysis?

The above procedure executes for each node in the network, corresponding to vertices in a graph \textit{G}. Nodes not yet part of any zone are designated the center of the next zone, which is formed by a breadth-first search starting at the center node and extending to \textit{r} hops. The procedure will exit once all nodes belong to at least one zone. This guarantees full coverage of the network into multiple, possibly overlapping zones. The procedure then returns the collection of zones which cover \textit{G}.

\subsection{Route Maintenance}

Once the network has been divided into zones, the routing table of each zone must be established and periodically maintained. Note that each zone's routing table is initialized to an empty table on startup. Routing tables store the optimal path between each pair of nodes within a zone. This process begins once Z-BAR itself moves from setup to launch. On a designated time interval, each zone updates its routing table based on the latest traffic data. This data is gathered by a peer-to-peer system such as a Vehicular Ad-Hoc Network (VANET). Dividing the network into zones elimintates the need for a central route assignment authority. Frequent routing table updates allows zones to capture the pseudostatic nature of traffic networks: the network topology is constant while the weight of each edge is subject to change.

\begin{algorithm}[H]
  \caption{Route Maintenance}
  \label{route_maintenance}
  \begin{algorithmic}[1]
  \Procedure{UpdateRoutingTable}{$Weights$}
  \State{$paths \gets optimalPaths(nodes,\ edges,\ Weights)$}
  \For{$u,v \in nodes$}
    \State{$table[u,\ v] \gets paths[u,\ v]$}
  \EndFor
  \EndProcedure
  \end{algorithmic}
\end{algorithm}

The above procedure is meant to be executed upon each zone on a regular schedule. This may correspond to daily, hourly, or minute-by-minute updates. The update schedule of routing tables may be adjusted depending on past and expected traffic fluctuations within the zone. Since intrazone routes are not dependent on other zones or any shared resources, the update procedure of each zone's routing table may be executed in parallel. Zones may be managed by individual threads or compute nodes, resulting in further scalability. Optimal paths between each pair of nodes \textit{u, v} within the zone are discovered by an execution of the Floyd-Warshall algorithm. The route maintenance step is intended to be executed continually by Z-BAR, allowing vehicles in the system to use multiple intrazone routing tables for route discovery.

\subsection{Route Discovery}

In Z-BAR, vehicles regularly make queries to their current zone regarding the optimal path to their destination. This allows for high responsiveness to any changes in traffic conditions. When discovering a route, vehicles begin their search at the most immediate upcoming node. Suppose a vehicle \textit{v} is present on an edge \textit{e} at time \textit{t}. \textit{V} will begin its search at the source node \textit{s}, where \textit{s} is the node \textit{e} leads to. This prevents vehicles from constructing paths with nodes which they have already passed. Route discovery is the process vehicles engage in when searching for an updated route assignment. This is divided into two aspects: single-zone and multi-zone. Single-zone route discovery occurs when a vehicle's source and destination reside in one zone. Multi-zone discovery occurs when a vehicle's source and destination reside in separate zones, requiring the concatenation of multiple single-zone paths. Vehicles initiate the route discovery process by sending a routing request to the zones of its current edge. Zones independently communicate and ultimately relay the optimal path back to the requesting vehicle.

\subsubsection{Single-Zone Route Discovery}

Single-Zone route discovery is the core aspect of route discovery in Z-BAR. Single zone route discovery occurs when the vehicle's source \textit{s} and the destination \textit{d} share a zone. This is effectively the base-case of Z-BAR's route discovery approach. When a routing request is initiated, vehicles begin at their next upcoming node. Since each node in the system may belong to multiple zones, each zone which covers the start node must be considered. In this case, the vehicle's route is compared to the value of the zone's routing table at \textit{s, d}, and reassigned if an improvement is found.

% pseudocode for single zone discovery
\begin{algorithm}[H]
  \caption{Single-Zone Discovery}
  \label{route_discovery_single_zone}
  \begin{algorithmic}[1]
  \Procedure{SZDiscovery}{$src, dest$}
  \State{$assert\ src \neq dest$}
  \State{$zones \gets AllZones(src).filter(z: dest \in z)$}
  \State{$paths \gets zones.map(z: z.table[src,dest])$}
  \State{$return\ min(paths)$}
  \EndProcedure
  \end{algorithmic}
\end{algorithm}

% Give a quick description.
Single-zone discovery assumes \textit{s} and \textit{d} are two distinct nodes in the same zone. If the vehicle's source \textit{is} its destination, no work is required and the procedure exits. Otherwise, all zones containing both the source and destination nodes are gathered and mapped to their corresponding \textit{src, dest} table entries. The minimum of these routes is assigned to the vehicle if it has a lower cost than the vehicle's existing route. The cost of a route corresponds to the traffic density model used. If no zones containing the source node also contain the destination node, Z-BAR defers to multi-zone discovery.

\subsubsection{Multi-Zone Route Discovery}

A vehicle only engages in multi-zone discovery when \textit{s} and \textit{d} reside in separate zones. Multi-zone discovery searches for a path from each source zone. Zone make a routing request to their neighbours, submitting the path from the source node to the relevant border node. The neighbour then searches for the destination starting at the border node. The zone which contains the destination node uses a table-lookup and updates the final path for the initial zone. The initial zone determines and assigns the optimal path considering all candidates and the vehicle's current route. While Z-BAR prunes paths in favor of a single optimum, Z-BAR may be modified to compute multiple paths for any vehicle.

% pseudocode for multi zone discovery
\begin{algorithm}[H]
  \caption{Multi-Zone Discovery}
  \label{route_discovery_multi_zone}
  \begin{algorithmic}[1]
  \Procedure{MZDiscovery}{$src, dest, path$}
  \For{$z \in AllZones(src)$}
    \For{$b \in z.borderNodes$}
      \For{$\bar{z} \in AllZones(b): \bar{z}\ unvisited$}
        \State{$mark\ \bar{z}\ visited$}
        \State{$pathToB \gets z.table[src, b]$}
        \State{$MZDiscovery(b, dest, path+pathToB)$}
      \EndFor
    \EndFor
  \EndFor
  \EndProcedure
  \end{algorithmic}
\end{algorithm}

The multi-zone discovery procedure is responsible for forwarding routing requests to all neighbouring zones. Zones send the path from their source to their border, gathering the nodes required for a complete route. A collection of visited nodes is stored to ensure the multi-zone phase does not enter an unbounded loop. Zones continue to fan out in search for the vehicle's destination until it is found. Once the destination is found, Z-BAR executes the single-zone procedure (table lookup) and the vehicle's route is reassigned as needed. The multi-zone and single-zone procedures form the routing assignment component of Z-BAR.

\section{Simulation}

Z-BAR was tested against a vehicular network simulator for performance analysis purposes. Simulator for Urban MObility, SUMO [*] was selected as the simulation tool of choice. SUMO is a time-discrete, space-continuous microscopic simulator designed for analyzing the behavior of traffic systems, vehicular networks, and urban environments in general. SUMO is an open-source tool with support for network generation, real-world imports, route generation and simulation inspection with a GUI tool. SUMO represents graphs and vehicles as XML files, which work together to create a traffic simulation. SUMO also includes APIs including the TRAffic Control Interface (TRACI) [*] for documenting and recording simulation metrics such as vehicle timings and fuel emissions. In this work, SUMO and TRACI were used together to model the behavior Z-BAR in artificial and real-world road networks. Z-BAR was tested in a variety of simulations, using an ACO-based traffic density model inspired by [*], which also uses SUMO for experiments. Results from select experiments are discussed in the following section.

\begin{figure}[h]
\caption{A screenshot of vehicles in SUMO, colored based on their zone.}
\centering
\includegraphics[scale=0.2]{sumo_screenshot}
\end{figure}

% Need CSV output for metrics
\section{Experiments and Results} % exec over large scale data (Continue getting script to run)

Experiments of Z-BAR were run against various networks of increasing size and population. This section covers the results of select experiments. A medium-sized (700 edges) network with a large population (3500 vehicles) and a large-sized network (1400 edges) with a similar population (4500 vehicles) were tested. Both of the networks used in this work were generated by the SUMO NETGENERATE tool. These networks and vehicle populations are meant to reflect real-world traffic conditions. Each vehicle in the system is assigned a source and destination node. Vehicles embark on their route via a single execution of Dijkstra's algorithm to determine the shortest path. Z-BAR re-assigns routes to vehicles based on real-time changes in traffic congestion. In the following figure, the difference in travel time and wait-time is shown between Z-BAR and the Dijkstra's algorithm approach against the largest of the two simulation networks.

% Graphs that show decrease in travel/wait time. Need to use Z-BAR (could be slow to exec...)

The goal of Z-BAR is to achieve efficient traffic route optimization in a scalable manner. In order to illustrate the scalability of Z-BAR, an additional set of experiments was conducted to compare Z-BAR against a route-assignment system that does not use zones, as seen in the related work of  [*] and [*]. Such works use repeated exuection of a path traversal algorithm to reassign vehicle routes. On the computing hardware described, the difference in speed between Z-BAR and repeated path traversal is shown in the figures below.

% Computing arch table
\begin{table}[H]
\renewcommand{\arraystretch}{1.5}
\caption{Experimental Hardware}
\label{table_example}
\centering

\begin{tabular}{|c|c|}
\hline
Attribute & Value\\
\hline
Operating System & Ubuntu 14.04 on Windows 10 64bit\\
\hline
CPU & Intel(R) i7-4720\\
\hline
Cores & 8 (2 logical cores per 4 physical cores)\\
\hline
Clock Speed & 3.36GHz\\
\hline
Memory (RAM) & 8 GB\\
\hline
\end{tabular}
\end{table}

% Also winnipeg?

\section{Conclusions and Future Work} % what did we find?

In this work, a novel algorithm for traffic assignment networks is proposed. The Z-BAR algorithm introduces the concept of zones into traffic assignment networks to achieve scalability. By dividing the network into zones, Z-BAR allows for fast path evaluation, as the path within every zone is stored in advance. In Z-BAR, paths are evaluated by combining multiple intrazone paths, whereas other research works use optimal-path algorithms such as Dijkstra's algorithm to assign routes to vehicles. The advantage of Z-BAR is the fact that vehicles need not evaluate the cost of each edge - this information is already stored by the corresponding zone. To our knowledge, this algorithm is the first to use the concept of zones for traffic optimization networks. 

Z-BAR was able to reduce traffic congestion in simulated networks, and does so with low execution times, even in large networks. We show that the size of the network poses little impact on the performance of Z-BAR, allowing us to conclude that Z-BAR will scale to very large urban centers.

There are multiple areas to explore in terms of future work. Experiments in this work used a zone radius r of 2. Alternative zone sizes will be explored to determine the optimal zone size. In addition, the idea of variable zone sizes, including dynamic zone sizes will be explored. For example, zones could grow or shrink depending on the amount of traffic represented within the zone. A largely empty area (such as a residential area) could be covered completely by one zone, while a busy downtown core could be distributed amongst many small zones. We will also introduce variation into exactly how many zones the network is divided into. At the computational level, more experiments will be run on larger data including real-world data. Z-BAR will also be executed on a parallel computer to demonstrate the full effect of its scalability.

\begin{thebibliography}{1}
\bibitem{iaco} Capela, José \& Machado, Penousal \& Castro Silva, Daniel \& Henriques Abreu, Pedro. (2014). An Inverted Ant Colony Optimization approach to traffic. Engineering Applications of Artificial Intelligence. 36. 122-133. 10.1016/j.engappai.2014.07.005. 
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\bibitem{}
\end{thebibliography}

\end{document}
